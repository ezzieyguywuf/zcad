# Gemini Agent Instructions

This document provides instructions for any Gemini agent interacting with the `zcad` codebase.

## Architectural Goals

This project is a Boundary Representation (B-rep) Computer-Aided Design (CAD) program. A primary architectural goal is the **separation of concerns** between the core data model and the renderer.

- The **`World` struct (`src/World.zig`)** is the central, authoritative data model. It should only contain abstract geometric data (and eventually, topological data). It should be completely independent of any rendering-specific concepts.
- The **`Renderables` structs (`src/Renderables.zig`)** are transient, concrete data structures generated for the GPU. They represent the tessellated output of the `World`.
- The **Renderer (`src/VulkanRenderer.zig`)** consumes `Renderables` but should know nothing about the `World`.

Please ensure all changes respect and enhance this separation.

## Code Formatting

This project uses specific formatters. Before committing, **you must format any files you modify**.

- **Zig Files (`.zig`):** Use the built-in `zig fmt`.
  - To format all source files: `zig fmt src`
- **Shader Files (`.frag`, `.vert`):** Use `clang-format`.
  - To format all shaders: `find shaders -type f \( -name "*.frag" -o -name "*.vert" \) -print0 | xargs -0 clang-format -i`
- **Markdown Files (`.md`):** Use `mdformat`.
  - To format all Markdown: `mdformat .`

## User Preferences

- **Comments:** Do not remove existing comments. New comments should be on their own line and used to explain the "why" of complex code, not the "what". Notes to the user should be clearly labeled, e.g., `// NOTE TO WOLFGANGSANYER: ...`
- **Test Naming:** Test names should be specific and descriptive (e.g., `"World bounding box expansion"`), not vague (e.g., `"World operations"`).
- **Data Structures:** Prefer `std.ArrayList` and pass the allocator explicitly to methods that require it (`append`, `deinit`, etc.).
- **Function Arguments:** For structs larger than a pointer (like `geom.Point`), pass them by constant pointer (`*const T`) to avoid unnecessary stack copies.
- **Error Handling:** In the HTTP server, do not use `try` in a way that would crash the server. Catch potential errors, log them, and return a `500` status code to the client.
